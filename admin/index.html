<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Admin – BookVault</title>
    <!-- Netlify Identity -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <!-- ESSAI 1 : jsDelivr -->
    <script src="https://cdn.jsdelivr.net/npm/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
    <!-- ESSAI 2 (secours) : unpkg, seulement si le 1er CDN ne charge pas -->
    <script>
      window.addEventListener('error', function(e){
        if (!window.CMS) {
          var s = document.createElement('script');
          s.src = "https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js";
          document.head.appendChild(s);
        }
      }, { once:true });
    </script>
    <style>
      body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
      .err{max-width:700px;margin:20vh auto 0;padding:16px;border:1px solid #e5e7eb;border-radius:12px;background:#fff}
      .err h1{font-size:20px;margin:0 0 8px}
      .muted{color:#6b7280;font-size:14px}
    </style>
  </head>
  <body>
    <noscript>
      <div class="err"><h1>JavaScript requis</h1><p class="muted">Active JavaScript pour utiliser le panneau d’administration.</p></div>
    </noscript>
    <div id="cms-root"></div>
    <script>
      // Afficher un message clair si la config ne se charge pas
      setTimeout(function(){
        if (!window.CMS) {
          document.body.innerHTML = '<div class="err"><h1>Impossible de charger Netlify CMS</h1><p class="muted">Le CDN est peut-être bloqué. Recharge la page (Ctrl+F5) ou réessaie en navigation privée. Si le problème persiste, vérifie que <code>/admin/config.yml</code> est bien accessible et valide.</p></div>';
        }
      }, 4000);
    </script>
  </body>
</html>
